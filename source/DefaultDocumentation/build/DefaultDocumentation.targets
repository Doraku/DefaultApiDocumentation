<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	<Target Name="DefaultDocumentation" AfterTargets="PostBuildEvent" Condition="'$(GenerateDocumentationFile)' == 'true' AND '$(DisableDefaultDocumentation)' != 'true'">
		<PropertyGroup>
			<DefaultDocumentationFallbackToolTargetFramework>net5.0</DefaultDocumentationFallbackToolTargetFramework>
			<DefaultDocumentationFallbackTool>$(MSBuildThisFileDirectory)../tools/$(DefaultDocumentationFallbackToolTargetFramework)/DefaultDocumentation.dll</DefaultDocumentationFallbackTool>
			<DefaultDocumentationTool>$(MSBuildThisFileDirectory)../tools/$(TargetFramework)/DefaultDocumentation.dll</DefaultDocumentationTool>

			<DocumentationFile Condition="'$(DocumentationFile)' != ''">$([System.IO.Path]::GetFullPath($(DocumentationFile)))</DocumentationFile>

			<DefaultDocumentationFolder Condition="'$(DefaultDocumentationFolder)' != ''">$([System.IO.Path]::GetFullPath($(DefaultDocumentationFolder)))</DefaultDocumentationFolder>
			<DefaultDocumentationFileNameMode Condition="'$(DefaultDocumentationFileNameMode)' == ''">FullName</DefaultDocumentationFileNameMode>
			<DefaultDocumentationNestedTypeVisibility Condition="'$(DefaultDocumentationNestedTypeVisibility)' == ''">Namespace</DefaultDocumentationNestedTypeVisibility>
			<DefaultDocumentationLinksFile Condition="'$(DefaultDocumentationLinksFile)' != ''">$([System.IO.Path]::GetFullPath($(DefaultDocumentationLinksFile)))</DefaultDocumentationLinksFile>
			<DefaultDocumentationWikiLinks Condition="'$(DefaultDocumentationWikiLinks)' == ''">false</DefaultDocumentationWikiLinks>

			<DefaultDocumentationArgs>/assembly:"$(TargetPath)" /xml:"$(DocumentationFile)"</DefaultDocumentationArgs>
			<DefaultDocumentationOptionalArgs>/output:"$(DefaultDocumentationFolder)" /home:"$(DefaultDocumentationHome)" /fileNameMode:"$(DefaultDocumentationFileNameMode)" /nestedTypeVisibility:"$(DefaultDocumentationNestedTypeVisibility)" /invalidCharReplacement:"$(DefaultDocumentationInvalidCharReplacement)" /wikiLinks:"$(DefaultDocumentationWikiLinks)"</DefaultDocumentationOptionalArgs>
		</PropertyGroup>

		<Warning Condition="!Exists('$(DefaultDocumentationTool)')"
			Text="Target framework `$(TargetFramework)` is not supported by DefaultDocumentation. Fallbacking to `$(DefaultDocumentationFallbackToolTargetFramework)`." />
		<Exec Condition="Exists('$(DefaultDocumentationTool)')"
			Command="dotnet &quot;$(DefaultDocumentationTool)&quot; $(DefaultDocumentationArgs) $(DefaultDocumentationOptionalArgs)"/>
	
		<Error Condition="!Exists('$(DefaultDocumentationFallbackTool)')"
			Text="Fallback default documentation tool `$(DefaultDocumentationFallbackTool)` doesn't exist. You can configure default fallback target framework by specifying `DefaultDocumentationFallbackToolTargetFramework` property." />
		<Exec Condition="Exists('$(DefaultDocumentationFallbackTool)')"
				Command="dotnet &quot;$(DefaultDocumentationFallbackTool)&quot; $(DefaultDocumentationArgs) $(DefaultDocumentationOptionalArgs)"/>

	</Target>
</Project>